# 第10章の章末問題の解答

## 注意

公式の解答は未公開であり、解答の正誤を確認しておりません。

## 問題10.1

N = 4 のとき、下図のような二分木が高さ３なので条件を満たす（二分木には見えないが）。この本の定義では、k 分木の各頂点は「高々 k 個の子頂点」を持つので、N - 1 個の頂点が１つの子頂点のみを持つように（つまり連結リストになるように）グラフを構成しても k 分木と呼んで良い。N 個の頂点を持つ木構造は必ず N - 1 本の辺を持つ（根を除く全ての頂点が、親頂点と自分自身に接続するただ一本の辺を持っている）ので、頂点数 N の二分木が高さ N - 1 であるとき、木の形は必ずこのような連結リストの形になる。

```
  O
   \
    O
     \
      O
       \
        O
```



## 問題10.2

まず、5 を挿入したとき。初めからヒープの条件を満たすのでそのまま。

```
木：
  5

配列：
5
```

次に、6 を挿入したとき。頂点 1 の値が親である頂点 0 の値より大きくなってしまうので、両者の値を交換する。

```
木：
  6
 /
5

配列：
65
```

次に、1 を挿入したとき。頂点 2 の値は親である頂点 0 の値より小さいので、ヒープの条件を満たしており、そのままの状態となる。

```
木：
  6
 / \
5   1

配列：
651
```



## 問題10.3

３個目までの挿入操作は問題10.2と同様なので、続きから。

2 を挿入したとき。ヒープの条件を満たしているので、そのまま。

```
木：
    6
   / \
  5   1
 /
2

配列：
6512
```

7 を挿入したとき。まず頂点 1 と頂点 4 の値（5 と 7）を交換。それから頂点 0 と頂点 1 の値（6 と 7）の値を交換。

```
木：
    7
   / \
  6   1
 / \
2   5

配列：
76125
```

3 を挿入したとき。頂点 2 と頂点 5 の値（1 と 3）を交換。

```
木：
     7
   /   \
  6     3
 / \   /
2   5 1

配列：
763251
```

4 を挿入したとき。頂点 2 と頂点 6 の値（3 と 4）を交換。

```
木：
     7
   /   \
  6     4
 / \   / \
2   5 1   3

配列：
7642513
```



## 問題10.4

高さ h の強平衡二分木について、頂点数を N 個とすると、2^h - 1 < N <= 2^(h+1) - 1 が成り立つ。式変形して log_2 (N+1) - 1 <= h < log_2 (N+1)。以上より、h = O(log N) である。



## 問題10.5

数学的帰納法により示す。

### (i) N = 1 のとき

頂点が 1 つだけなので辺数は 0 である。N - 1 = 1 - 1 = 0 より成り立つ。

### (ii) N = k のとき成り立つと仮定して、N = k + 1 のとき

N = k + 1 の木の辺数を X とする。この木から、葉を 1 つ選んでこの頂点を v, その親を p とする。v を取り除く操作は v と p に接続する辺の除去も伴うため、v を取り除くと木の辺数は X - 1 となる。このときの木の頂点数は (k + 1) - 1 = k であり、仮定より辺数は k - 1なので、X - 1 = k - 1、すなわち X = k が成り立つ。よって、N = k + 1 のときも頂点数 N の木の辺数は N - 1 である。

(i), (ii) より、任意の正の整数 N について、頂点数が N の木の辺数が N - 1 であることが示された。
